name: create-labels
on:
  create:
    branches:
      - develop
env:
  EXTRA_PATH: ./extras/createLabels/
  CREATE_LABEL: ./.github/workflows/create-labels.yml
jobs:
  build:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: üì¶ INSTALL NODE LTS
        uses: actions/setup-node@v3
        with:
          node-version: lts/*
      - name: üöõ CARGANDO DEPENDENCIAS
        run: |
          cd $EXTRA_PATH
          npm init -y
          npm i isomorphic-fetch
      - name: üèó CREANDO ETIQUETAS
        run: |
          cd $EXTRA_PATH
          node ./index.js ${{ secrets.GITHUB_TOKEN }} ${{ github.repository_owner }} ${{ github.repository }}
      - name: ‚öôÔ∏è CONFIGURANDO GIT
        run: |
          git config --local user.name "GitActionsBot"
          git config --local user.email "gitbot@git.com"
      - name: üõ† CREANDO RAMA MAIN
        run: |
          git checkout develop
          git fetch
          git pull
          git checkout -b main
          git push --set-upstream origin main
          ls
      - name: ‚≠ïÔ∏è BORRANDO EXTRAS
        run: |
          git checkout develop
          git rm -r $EXTRA_PATH
          git rm -r $CREATE_LABEL
          rm -R $EXTRA_PATH/package.json
          rm -R $CREATE_LABEL
          git add -A
          git status
          git commit -m "chore: Eliminando carpeta"
          git push
      - name: üîÑ SINCRONIZACION DE RAMAS
        run: |
          git checkout develop
          git fetch
          git pull
          git merge --no-ff main -m "Auto-merge create labels"
          git push
